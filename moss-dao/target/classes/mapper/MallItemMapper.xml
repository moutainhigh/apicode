<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.ycandyz.master.dao.mall.goodsManage.MallItemDao">
    <resultMap id="BaseResultMap" type="com.ycandyz.master.entities.mall.goodsManage.MallItem">
        <id column="shop_no" property="shopNo" jdbcType="VARCHAR"/>
        <id column="category_no" property="categoryNo" jdbcType="VARCHAR"/>
        <id column="item_no" property="itemNo" jdbcType="VARCHAR"/>
        <id column="item_name" property="itemName" jdbcType="VARCHAR"/>
        <id column="item_text" property="itemText" jdbcType="LONGVARCHAR" />
        <id column="banners" property="banners" jdbcType="VARCHAR" />
        <id column="base_sales" property="baseSales" jdbcType="INTEGER" />
        <id column="sort_value" property="sortValue" jdbcType="INTEGER" />
        <id column="share_descr" property="shareDescr" jdbcType="VARCHAR" />
        <id column="share_img" property="shareImg" jdbcType="VARCHAR" />
        <id column="stock" property="stock" jdbcType="INTEGER" />
        <id column="sub_stock_method" property="subStockMethod" jdbcType="INTEGER" />
        <id column="goods_no" property="goodsNo" jdbcType="VARCHAR" />
        <id column="deliver_method" property="deliverMethod" jdbcType="INTEGER" />
        <id column="status" property="status" jdbcType="INTEGER" />
        <id column="is_unify_shipping" property="isUnifyShipping" jdbcType="INTEGER" />
        <id column="unify_shipping" property="unifyShipping" jdbcType="DECIMAL" />
        <id column="shipping_no" property="shippingNo" jdbcType="VARCHAR" />
        <id column="initial_purchases" property="initialPurchases" jdbcType="INTEGER" />
        <id column="limit_cycle_type" property="limitCycleType" jdbcType="INTEGER" />
        <id column="limit_skus" property="limitSkus" jdbcType="INTEGER" />
        <id column="limit_orders" property="limitOrders" jdbcType="INTEGER" />
        <id column="pickup_address_ids" property="pickupAddressIds" jdbcType="VARCHAR" />
        <id column="delivery_type" property="deliveryType" jdbcType="VARCHAR" />
    </resultMap>

    <insert id="addMallItem" parameterType="com.ycandyz.master.entities.mall.goodsManage.MallItem">
        insert into mall_item(id,shop_no,category_no,item_no,item_name,item_text,item_cover,banners,base_sales,
        real_sales,sort_value,share_descr,share_img,price,lowest_sale_price,highest_sale_price,stock,frozen_stock,
        sub_stock_method,goods_no,deliver_method,status,is_unify_shipping,shipping_no,unify_shipping,initial_purchases,
        limit_cycle_type,limit_skus,limit_orders,qr_code_url,created_time,updated_time,is_enable_share,share_method,
        share_rate,share_amount,visits,is_updated_share,share_second_method,share_second_level_method,share_second_rate,
        share_second_amount,share_second_level_rate,share_second_level_amount,share_third_method,share_third_level_method,
        share_third_rate,share_third_amount,share_third_level_rate,share_third_level_amount,delivery_type,pickup_address_ids,
        delivery_type_bak)
        values (#{id},#{shopNo},#{categoryNo},#{itemNo},#{itemName},#{itemText},#{itemCover},
        #{banners},#{baseSales},#{realSales},#{sortValue},#{shareDescr},#{shareImg},#{price},
        #{lowestSalePrice},#{highestSalePrice},#{stock},#{frozenStock},#{subStockMethod},
        #{goodsNo},#{deliverMethod},#{status},#{isUnifyShipping},#{shippingNo},#{unifyShipping},
        #{initialPurchases},#{limitCycleType},#{limitSkus},#{limitOrders},#{qrCodeUrl},now(),
        now(),#{isEnableShare},#{shareMethod},#{shareRate},#{shareAmount},#{visits},#{isUpdatedShare},
        #{shareSecondMethod},#{shareSecondLevelMethod},#{shareSecondRate},#{shareSecondAmount},
        #{shareSecondLevelRate},#{shareSecondLevelAmount},#{shareThirdMethod},#{shareThirdLevelMethod},#{shareThirdRate},
        #{shareThirdAmount},#{shareThirdLevelRate},#{shareThirdLevelAmount},#{deliveryType},#{pickupAddressIds},#{deliveryTypeBak});
    </insert>

    <delete id="delMallItemByItemNo" parameterType="java.lang.String">
        delete t1,t2,t3 from mall_item as t1
        left join mall_sku as t2 on t1.item_no = t2.item_no
        left join mall_sku_spec as t3 on t2.sku_no = t3.sku_no
        where t1.shop_no = #{shopNo} and t1.item_no = #{itemNo};
    </delete>
        <select id="selMallItemByitemNo" resultMap="BaseResultMap" parameterType="java.lang.String">
        select * from mall_item where shop_no = #{shopNo} and item_no = #{itemNo};
    </select>
    <update id="oprbyItemNo">
        update mall_item set status = #{status} where item_no in
        <foreach collection="itemNoList" item="state" open="(" separator="," close=")">
            #{state}
        </foreach>
    </update>

</mapper>


